!function(){function t(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||r(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,c=t[Symbol.iterator]();!(n=(a=c.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(s){o=!0,i=s}finally{try{n||null==c.return||c.return()}finally{if(o)throw i}}return r}(t,e)||r(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){if(t){if("string"==typeof t)return n(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,n=s(t);if(e){var o=s(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return c(this,r)}}function c(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(t,e,r){return e&&b(t.prototype,e),r&&b(t,r),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"5tjk":function(r,n,i){"use strict";i.r(n),i.d(n,"PeopleModule",function(){return Ae});var c,s,b=i("tyNb"),d=i("XNiG"),m=i("LRne"),p=i("1G5W"),f=i("Kj3r"),g=i("eIep"),h=i("HnnZ"),v=i("hgo/"),S=i("ufcJ"),y=i("z6cu"),O=i("vkgz"),R=i("JIr8"),_=i("Wcn/"),k={customer:{id:NaN,_id:NaN,name:"",contacts:{email:"",inst:"",phone:""},address:{city:"",address:""}},orders:[{id:"NaN",_id:"NaN",personId:NaN,sended:!1,shipmentDate:"",shipmentType:_.c.post,trackNumber:"",type:_.b.check,orderDate:"",orderStructure:{kits:[],theatres:[]},comment:""}],loadingState:null},C=i("fXoL"),x=i("AytR"),F=i("tk/3"),N=((c=function(){function t(e){u(this,t),this.http=e,this.formDataInitState={orders:[],customer:k.customer}}return l(t,[{key:"updateFormData",value:function(t){var e,r=localStorage.getItem("ntv-add-order-form-data");return e=Object.assign(Object.assign({},r?JSON.parse(r):this.formDataInitState),t),localStorage.setItem("ntv-add-order-form-data",JSON.stringify(e)),Object(m.a)(e)}},{key:"getFormData",value:function(){var t=localStorage.getItem("ntv-add-order-form-data"),e=t?JSON.parse(t):this.formDataInitState;return Object(m.a)(e)}},{key:"getPersonsByName",value:function(t){return this.http.post(x.a.apiEndpoints.customersForAutocomplete,{name:t})}},{key:"postOrders",value:function(t){return this.http.post(x.a.apiEndpoints.postOrders,t)}},{key:"postCustomer",value:function(t){return this.http.post(x.a.apiEndpoints.postCustomer,t)}}]),t}()).\u0275fac=function(t){return new(t||c)(C.Wb(F.a))},c.\u0275prov=C.Ib({token:c,factory:c.\u0275fac,providedIn:"root"}),c),B=i("0IaG"),P=((s=function(t){o(n,t);var r=a(n);function n(t,o){var i;return u(this,n),(i=r.call(this,k)).addOrderService=t,i.dialog=o,i.saveForm=i.effect(function(t){return t.pipe(Object(g.a)(function(t){var e={},r=Array.isArray(t);return i.reqFormPending(),r?e.orders=t:e.customer=t,i.addOrderService.updateFormData(e).pipe(Object(O.a)(function(t){i.reqFormSuccess(t)}),Object(R.a)(function(t){return i.reqFormError(),Object(y.a)(t)}))}))}),i.setFormData=i.effect(function(t){return t.pipe(Object(g.a)(function(){return i.reqFormPending(),i.addOrderService.getFormData().pipe(Object(O.a)(function(t){i.reqFormSuccess(t)}),Object(R.a)(function(t){return i.reqFormError(),Object(y.a)(t)}))}))}),i.registerNewOrder=i.effect(function(t){return t.pipe(Object(g.a)(function(t){return i.reqFormPending(),i.addOrderService.getPersonsByName(t.customer.name).pipe(Object(g.a)(function(r){return r.length?(t.orders.forEach(function(t){t.personId=r[0].id}),i.addOrderService.postOrders(t.orders).pipe(Object(O.a)(function(){i.resetState(),i.dialog.closeAll()}))):i.addOrderService.postCustomer(t.customer).pipe(Object(g.a)(function(r){var n=e(r,1)[0];return t.orders.forEach(function(t){t.personId=n.id}),i.addOrderService.postOrders(t.orders).pipe(Object(O.a)(function(){i.resetState(),i.dialog.closeAll()}))}))}),Object(R.a)(function(t){return i.reqFormError(),Object(y.a)(t)}))}))}),i.resetState=i.updater(function(t){return k}),i.reqFormPending=i.updater(function(t){return Object.assign(Object.assign({},t),{loadingState:v.a.loading})}),i.reqFormSuccess=i.updater(function(t,e){return Object.assign(Object.assign({},e),{loadingState:null})}),i.reqFormError=i.updater(function(t){return Object.assign(Object.assign({},t),{loadingState:v.a.err})}),i}return n}(S.a)).\u0275fac=function(t){return new(t||s)(C.Wb(N),C.Wb(B.b))},s.\u0275prov=C.Ib({token:s,factory:s.\u0275fac}),s),j=i("7EHt"),z=i("3Pt+"),M=i("kmnG"),w=i("qFsG"),I=i("/1cH"),$=i("ofXK"),T=i("bTqV"),A=i("NFeN"),D=i("FKr1");function G(t,e){if(1&t&&(C.Sb(0,"mat-option",14),C.zc(1),C.Rb()),2&t){var r=e.$implicit;C.ic("value",r),C.Bb(1),C.Bc(" ",r.name," ")}}var E,K=((E=function(){function e(t,r,n){u(this,e),this.fb=t,this.store=r,this.addOrderService=n,this.destroyer$$=new d.a,this.loadingStates=v.a,this.autocompleteOptions=[]}return l(e,[{key:"ngOnInit",value:function(){this.initForm(),this.loadingState$=this.store.select(function(t){return t.loadingState}),this.initFormSetter(),this.initFormSaver(),this.initAutocomplete()}},{key:"ngOnDestroy",value:function(){this.destroyer$$.next(),this.destroyer$$.complete()}},{key:"setCustomerFromAutocomplete",value:function(t){this.store.saveForm(t.option.value)}},{key:"resetForm",value:function(){this.store.saveForm(k.customer)}},{key:"initForm",value:function(){this.addCustomerForm=this.fb.group({id:NaN,_id:"",name:"",contacts:this.fb.group({email:"",inst:"",phone:""}),address:this.fb.group({city:"",address:""})})}},{key:"initFormSetter",value:function(){var t=this;this.store.select(function(t){return t.customer}).pipe(Object(p.a)(this.destroyer$$),Object(O.a)(function(e){t.isCustomersEqual(t.addCustomerForm.value,e)||t.addCustomerForm.setValue(e)})).subscribe()}},{key:"initFormSaver",value:function(){var t=this;this.addCustomerForm.valueChanges.pipe(Object(p.a)(this.destroyer$$),Object(f.a)(500)).subscribe(function(e){return t.store.saveForm(e)})}},{key:"initAutocomplete",value:function(){var t,e=this;null===(t=this.addCustomerForm.get("name"))||void 0===t||t.valueChanges.pipe(Object(p.a)(this.destroyer$$),Object(f.a)(300),Object(g.a)(function(t){return e.addOrderService.getPersonsByName(t)})).subscribe(function(t){e.autocompleteOptions=t})}},{key:"isCustomersEqual",value:function(t,e){var r=this.getDeepValues(Object.values(t)),n=this.getDeepValues(Object.values(e));return r.every(function(t){return n.includes(t)})}},{key:"getDeepValues",value:function(e){var r=this;return e.reduce(function(e,n){return"object"!=typeof n||null===n?e.push(n):Array.isArray(n)?e.push.apply(e,t(r.getDeepValues(n))):e.push.apply(e,t(r.getDeepValues(Object.values(n)))),e},[])}}]),e}()).\u0275fac=function(t){return new(t||E)(C.Mb(z.e),C.Mb(P),C.Mb(N))},E.\u0275cmp=C.Gb({type:E,selectors:[["ntv-customer-form"]],decls:33,vars:3,consts:[[1,"form",3,"formGroup"],["appearance","standard"],["matInput","","formControlName","name",3,"matAutocomplete"],[3,"optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["formGroupName","contacts",1,"form__group"],["matInput","","formControlName","email"],["matInput","","formControlName","inst"],["matInput","","formControlName","phone"],["formGroupName","address",1,"form__group"],["matInput","","formControlName","city"],["matInput","","formControlName","address"],["mat-icon-button","",3,"click"],[3,"value"]],template:function(t,e){if(1&t&&(C.Sb(0,"form",0),C.Sb(1,"mat-form-field",1),C.Sb(2,"mat-label"),C.zc(3,"\u0424\u0418\u041e"),C.Rb(),C.Nb(4,"input",2),C.Sb(5,"mat-autocomplete",3,4),C.Zb("optionSelected",function(t){return e.setCustomerFromAutocomplete(t)}),C.xc(7,G,2,2,"mat-option",5),C.Rb(),C.Rb(),C.Sb(8,"div",6),C.Sb(9,"mat-form-field",1),C.Sb(10,"mat-label"),C.zc(11,"E-mail"),C.Rb(),C.Nb(12,"input",7),C.Rb(),C.Sb(13,"mat-form-field",1),C.Sb(14,"mat-label"),C.zc(15,"\u0418\u043d\u0441\u0442\u0430\u0433\u0440\u0430\u043c"),C.Rb(),C.Nb(16,"input",8),C.Rb(),C.Sb(17,"mat-form-field",1),C.Sb(18,"mat-label"),C.zc(19,"\u0422\u0435\u043b\u0435\u0444\u043e\u043d"),C.Rb(),C.Nb(20,"input",9),C.Rb(),C.Rb(),C.Sb(21,"div",10),C.Sb(22,"mat-form-field",1),C.Sb(23,"mat-label"),C.zc(24,"\u0413\u043e\u0440\u043e\u0434"),C.Rb(),C.Nb(25,"input",11),C.Rb(),C.Sb(26,"mat-form-field",1),C.Sb(27,"mat-label"),C.zc(28,"\u041e\u0441\u0442\u0430\u043b\u044c\u043d\u043e\u0439 \u0430\u0434\u0440\u0435\u0441"),C.Rb(),C.Nb(29,"input",12),C.Rb(),C.Sb(30,"button",13),C.Zb("click",function(){return e.resetForm()}),C.Sb(31,"mat-icon"),C.zc(32,"refresh"),C.Rb(),C.Rb(),C.Rb(),C.Rb()),2&t){var r=C.nc(6);C.ic("formGroup",e.addCustomerForm),C.Bb(4),C.ic("matAutocomplete",r),C.Bb(3),C.ic("ngForOf",e.autocompleteOptions)}},directives:[z.v,z.o,z.h,M.c,M.f,w.b,z.c,I.c,z.n,z.g,I.a,$.j,z.i,T.a,A.a,D.n],styles:[".form[_ngcontent-%COMP%]{flex-direction:column;padding:16px 0}.form[_ngcontent-%COMP%], .form__group[_ngcontent-%COMP%]{display:flex;gap:16px}.form__loading-state[_ngcontent-%COMP%]{justify-self:flex-end;align-self:flex-end}.form__refresh-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 40px;grid-gap:16px}"]}),E),Z=i("wZkO"),V=i("IzEk"),q=i("G1Gu"),J=i("f0Cb"),Q=i("Wp6s"),W=i("d3UM");function H(t,e){if(1&t&&(C.Sb(0,"mat-option",15),C.zc(1),C.Rb()),2&t){var r=e.$implicit;C.ic("value",r),C.Bb(1),C.Bc(" ",r," ")}}function X(t,e){if(1&t){var r=C.Tb();C.Sb(0,"mat-card",10),C.Sb(1,"mat-form-field",11),C.Sb(2,"mat-label"),C.zc(3,"\u0441\u043a\u043e\u043b\u044c\u043a\u043e"),C.Rb(),C.Nb(4,"input",12),C.Rb(),C.Sb(5,"button",5),C.Zb("click",function(){C.pc(r);var t=e.index;return C.dc().removeKit(t)}),C.Sb(6,"mat-icon"),C.zc(7,"delete"),C.Rb(),C.Rb(),C.Sb(8,"mat-form-field",11),C.Sb(9,"mat-label"),C.zc(10,"\u0432\u043e\u0437\u0440\u0430\u0441\u0442"),C.Rb(),C.Sb(11,"mat-select",13),C.xc(12,H,2,2,"mat-option",14),C.Rb(),C.Rb(),C.Rb()}if(2&t){var n=e.$implicit,o=C.dc();C.Bb(4),C.ic("formControl",o.getControl(n.get("count"))),C.Bb(7),C.ic("formControl",o.getControl(n.get("age"))),C.Bb(1),C.ic("ngForOf",o.ages)}}function U(t,e){if(1&t&&(C.Sb(0,"mat-option",17),C.zc(1),C.Rb()),2&t){var r=e.$implicit;C.ic("value",r),C.Bb(1),C.Bc(" ",r," ")}}function L(t,e){if(1&t){var r=C.Tb();C.Sb(0,"mat-card",10),C.Sb(1,"mat-form-field",11),C.Sb(2,"mat-label"),C.zc(3,"\u0441\u043a\u043e\u043b\u044c\u043a\u043e"),C.Rb(),C.Nb(4,"input",12),C.Rb(),C.Sb(5,"button",5),C.Zb("click",function(){C.pc(r);var t=e.index;return C.dc().removeTheatre(t)}),C.Sb(6,"mat-icon"),C.zc(7,"delete"),C.Rb(),C.Rb(),C.Sb(8,"mat-form-field",11),C.Sb(9,"mat-label"),C.zc(10,"\u0432\u043e\u0437\u0440\u0430\u0441\u0442"),C.Rb(),C.Sb(11,"mat-select",13),C.xc(12,U,2,2,"mat-option",16),C.Rb(),C.Rb(),C.Rb()}if(2&t){var n=e.$implicit,o=C.dc();C.Bb(4),C.ic("formControl",o.getControl(n.get("count"))),C.Bb(7),C.ic("formControl",o.getControl(n.get("age"))),C.Bb(1),C.ic("ngForOf",o.ages)}}var Y,tt=((Y=function(){function t(e,r,n){u(this,t),this.dialogRef=e,this.order=r,this.fb=n,this.ages=Object.values(_.a),this.initialKitGroupState={age:_.a.twoThree,count:0}}return l(t,[{key:"ngOnInit",value:function(){this.orderStructureForm=this.fb.group({orderStructure:this.fb.group({kits:this.fb.array([]),theatres:this.fb.array([])})}),this.setKitsAndTheatresControls(this.order)}},{key:"setStructure",value:function(){this.dialogRef.close(this.orderStructureForm.value.orderStructure)}},{key:"addKit",value:function(t){this.kits.push(this.fb.group(t))}},{key:"addTheatre",value:function(t){this.theatres.push(this.fb.group(t))}},{key:"removeKit",value:function(t){this.kits.removeAt(t)}},{key:"removeTheatre",value:function(t){this.theatres.removeAt(t)}},{key:"getControl",value:function(t){return t}},{key:"setKitsAndTheatresControls",value:function(t){var e=this;t.orderStructure.kits.forEach(function(t){e.addKit(t)}),t.orderStructure.theatres.forEach(function(t){e.addTheatre(t)})}},{key:"kits",get:function(){return this.orderStructureForm.get("orderStructure").get("kits")}},{key:"theatres",get:function(){return this.orderStructureForm.get("orderStructure").get("theatres")}}]),t}()).\u0275fac=function(t){return new(t||Y)(C.Mb(B.d),C.Mb(B.a),C.Mb(z.e))},Y.\u0275cmp=C.Gb({type:Y,selectors:[["ntv-add-order-structure-dialog"]],decls:24,vars:4,consts:[[1,"scrollbar"],[1,"form",3,"formGroup","ngSubmit"],["formGroupName","orderStructure",1,"form__block"],["formArrayName","kits",1,"form__array"],[1,"form__array-title"],["mat-icon-button","","type","button",3,"click"],["class","form__array-item",4,"ngFor","ngForOf"],[3,"vertical"],["formArrayName","theatres",1,"form__array"],["mat-raised-button",""],[1,"form__array-item"],["appearance","standard"],["type","number","matInput","",3,"formControl"],[3,"formControl"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["name","dsfsd",3,"value",4,"ngFor","ngForOf"],["name","dsfsd",3,"value"]],template:function(t,e){1&t&&(C.Sb(0,"ng-scrollbar",0),C.Sb(1,"form",1),C.Zb("ngSubmit",function(){return e.setStructure()}),C.Sb(2,"h4"),C.zc(3,"\u0427\u0442\u043e \u0432\u0435\u0437\u0435\u043c"),C.Rb(),C.Sb(4,"div",2),C.Sb(5,"div",3),C.Sb(6,"div",4),C.Sb(7,"h6"),C.zc(8,"\u041d\u0430\u0431\u043e\u0440\u044b"),C.Rb(),C.Sb(9,"button",5),C.Zb("click",function(){return e.addKit(e.initialKitGroupState)}),C.Sb(10,"mat-icon"),C.zc(11,"add"),C.Rb(),C.Rb(),C.Rb(),C.xc(12,X,13,3,"mat-card",6),C.Rb(),C.Nb(13,"mat-divider",7),C.Sb(14,"div",8),C.Sb(15,"div",4),C.Sb(16,"h6"),C.zc(17,"\u0422\u0435\u0430\u0442\u0440\u044b"),C.Rb(),C.Sb(18,"button",5),C.Zb("click",function(){return e.addTheatre(e.initialKitGroupState)}),C.Sb(19,"mat-icon"),C.zc(20,"add"),C.Rb(),C.Rb(),C.Rb(),C.xc(21,L,13,3,"mat-card",6),C.Rb(),C.Rb(),C.Sb(22,"button",9),C.zc(23,"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),C.Rb(),C.Rb(),C.Rb()),2&t&&(C.Bb(1),C.ic("formGroup",e.orderStructureForm),C.Bb(11),C.ic("ngForOf",e.kits.controls),C.Bb(1),C.ic("vertical",!0),C.Bb(8),C.ic("ngForOf",e.theatres.controls))},directives:[q.a,z.v,z.o,z.h,z.i,z.d,T.a,A.a,$.j,J.a,Q.a,M.c,M.f,z.r,w.b,z.c,z.n,z.f,W.a,D.n],styles:["[_nghost-%COMP%]{display:block;min-width:500px;margin:-24px}.form[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:16px;height:100%;padding:16px;box-sizing:border-box}.form__block[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1px 1fr;grid-gap:16px;width:100%}.form__array[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.form__array-item[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 40px;grid-template-rows:repeat(auto-fill,41px);grid-gap:16px}.form__array-title[_ngcontent-%COMP%]{display:flex;gap:16px;align-items:center}.scrollbar[_ngcontent-%COMP%]{max-height:70vh}"]}),Y),et=i("Qw0g"),rt=i("e1Hi");function nt(t,e){1&t&&(C.Sb(0,"h4"),C.zc(1,"\u041f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u043c \u0437\u0430\u043a\u0430\u0437\u044b"),C.Rb())}function ot(t,e){if(1&t&&(C.Sb(0,"mat-option",8),C.zc(1),C.Rb()),2&t){var r=e.$implicit;C.ic("value",r.date),C.Bb(1),C.Bc(" ",r.name," ")}}function it(t,e){if(1&t&&(C.Sb(0,"mat-option",8),C.zc(1),C.Rb()),2&t){var r=e.$implicit;C.ic("value",r),C.Bb(1),C.Bc(" ",r," ")}}function at(t,e){if(1&t){var r=C.Tb();C.Sb(0,"mat-card",2),C.Sb(1,"mat-form-field",3),C.Sb(2,"mat-label"),C.zc(3,"\u041c\u0435\u0441\u044f\u0446"),C.Rb(),C.Sb(4,"mat-select",4),C.xc(5,ot,2,2,"mat-option",5),C.Rb(),C.Rb(),C.Sb(6,"mat-form-field",3),C.Sb(7,"mat-label"),C.zc(8,"\u041e\u0442\u043f\u0440\u0430\u0432\u043a\u0430"),C.Rb(),C.Sb(9,"mat-select",4),C.xc(10,it,2,2,"mat-option",5),C.Rb(),C.Rb(),C.Sb(11,"ntv-overlined",6),C.Zb("click",function(){C.pc(r);var t=e.$implicit;return C.dc().showOrderStructureDialog(t.value)}),C.Rb(),C.Sb(12,"mat-form-field",3),C.Sb(13,"mat-label"),C.zc(14,"\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439"),C.Rb(),C.Nb(15,"input",7),C.Rb(),C.Rb()}if(2&t){var n=e.$implicit,o=C.dc();C.Bb(4),C.ic("formControl",o.getControl(n.get("shipmentDate"))),C.Bb(1),C.ic("ngForOf",o.months),C.Bb(4),C.ic("formControl",o.getControl(n.get("shipmentType"))),C.Bb(1),C.ic("ngForOf",o.shipmentTypes),C.Bb(5),C.ic("formControl",o.getControl(n.get("comment")))}}var ct,st=((ct=function(){function e(t,r,n){u(this,e),this.fb=t,this.store=r,this.dialog=n,this.orders=[],this.months=et.a,this.shipmentTypes=Object.values(_.c),this.destroyer$$=new d.a}return l(e,[{key:"ngOnInit",value:function(){this.ordersControls=this.fb.array([]),this.initFormSetter(),this.initFormSaver()}},{key:"ngOnDestroy",value:function(){this.destroyer$$.next(),this.destroyer$$.complete()}},{key:"showOrderStructureDialog",value:function(t){this.dialog.open(tt,{data:t})}},{key:"initFormSaver",value:function(){var t=this;this.ordersControls.valueChanges.pipe(Object(p.a)(this.destroyer$$),Object(f.a)(500)).subscribe(function(e){t.store.saveForm(e)})}},{key:"initFormSetter",value:function(){var t=this;this.store.select(function(t){return t.orders}).pipe(Object(p.a)(this.destroyer$$),Object(O.a)(function(e){e.length&&!t.isOrdersEqual(t.ordersControls.value,e)&&(t.ordersControls.clear(),e.forEach(function(e){t.addOrder(e)}))})).subscribe()}},{key:"isOrdersEqual",value:function(t,e){if(t.length!==e.length)return!1;var r=this.getDeepValues(t),n=this.getDeepValues(e);return r.length===n.length&&r.every(function(t){return n.includes(t)})}},{key:"getDeepValues",value:function(e){var r=this;return e.reduce(function(e,n){return"object"!=typeof n||null===n?e.push(n):Array.isArray(n)?e.push.apply(e,t(r.getDeepValues(n))):e.push.apply(e,t(r.getDeepValues(Object.values(n)))),e},[])}},{key:"addOrder",value:function(t){this.ordersControls.push(this.fb.group(t))}},{key:"getControl",value:function(t){return t}}]),e}()).\u0275fac=function(t){return new(t||ct)(C.Mb(z.e),C.Mb(P),C.Mb(B.b))},ct.\u0275cmp=C.Gb({type:ct,selectors:[["ntv-subscription-orders-form"]],inputs:{orders:"orders"},decls:2,vars:2,consts:[[4,"ngIf"],["class","array-item",4,"ngFor","ngForOf"],[1,"array-item"],["appearance","standard"],[3,"formControl"],[3,"value",4,"ngFor","ngForOf"],["overline","\u043d\u0430\u0431\u043e\u0440\u044b","value","\u041d\u0430\u0436\u043c\u0438",3,"click"],["matInput","",3,"formControl"],[3,"value"]],template:function(t,e){1&t&&(C.xc(0,nt,2,0,"h4",0),C.xc(1,at,16,5,"mat-card",1)),2&t&&(C.ic("ngIf",e.ordersControls.length),C.Bb(1),C.ic("ngForOf",e.ordersControls.controls))},directives:[$.k,$.j,Q.a,M.c,M.f,W.a,z.n,z.f,rt.a,w.b,z.c,D.n],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;gap:16px}.array-item[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,1fr);grid-gap:16px}"]}),ct);function ut(t,e){if(1&t&&(C.Sb(0,"mat-option",8),C.zc(1),C.Rb()),2&t){var r=e.$implicit;C.ic("value",r.date),C.Bb(1),C.Bc(" ",r.name," ")}}function bt(t,e){if(1&t&&(C.Sb(0,"mat-option",8),C.zc(1),C.Rb()),2&t){var r=e.$implicit;C.ic("value",r),C.Bb(1),C.Bc(" ",r," ")}}var lt,dt=((lt=function(){function e(t,r,n){u(this,e),this.fb=t,this.store=r,this.dialog=n,this.shipmentTypes=Object.values(_.c),this.months=et.a,this.destroyer$$=new d.a}return l(e,[{key:"ngOnInit",value:function(){this.addSubscriptionForm=this.fb.group({months:"",shipmentType:"",orderStructure:""}),this.initFormSetter(),this.initFormSaver()}},{key:"ngOnDestroy",value:function(){this.destroyer$$.next(),this.destroyer$$.complete()}},{key:"initFormSetter",value:function(){var t=this;this.store.select(function(t){return t.orders}).pipe(Object(p.a)(this.destroyer$$),Object(O.a)(function(e){if(e.length){var r={months:e.map(function(t){return t.shipmentDate}),shipmentType:e[0].shipmentType,orderStructure:e[0].orderStructure||k.orders[0].orderStructure};t.isArraysEqual(Object.values(r),Object.values(t.addSubscriptionForm.value))||t.addSubscriptionForm.setValue(r)}})).subscribe()}},{key:"initFormSaver",value:function(){var t=this;this.addSubscriptionForm.valueChanges.pipe(Object(p.a)(this.destroyer$$),Object(f.a)(500)).subscribe(function(e){if(Array.isArray(e.months)){var r=e.months.map(function(t){return{id:k.orders[0].id,personId:k.orders[0].personId,comment:k.orders[0].comment,sended:k.orders[0].sended,shipmentDate:t,shipmentType:e.shipmentType,trackNumber:k.orders[0].trackNumber,type:_.b.subscription,orderStructure:e.orderStructure,orderDate:(new Date).toISOString()}});t.store.saveForm(r)}})}},{key:"showOrderStructureSelectionDialog",value:function(){var t=this;this.store.select(function(t){return t.orders[0]}).pipe(Object(V.a)(1)).subscribe(function(e){t.dialog.open(tt,{data:e}).afterClosed().subscribe(function(e){t.addSubscriptionForm.patchValue({orderStructure:e})})})}},{key:"isArraysEqual",value:function(t,e){if(t.length!==e.length)return!1;var r=this.getDeepValues(t),n=this.getDeepValues(e);return r.length===n.length&&r.every(function(t){return n.includes(t)})}},{key:"getDeepValues",value:function(e){var r=this;return e.reduce(function(e,n){return"object"!=typeof n||null===n?e.push(n):Array.isArray(n)?e.push.apply(e,t(r.getDeepValues(n))):e.push.apply(e,t(r.getDeepValues(Object.values(n)))),e},[])}}]),e}()).\u0275fac=function(t){return new(t||lt)(C.Mb(z.e),C.Mb(P),C.Mb(B.b))},lt.\u0275cmp=C.Gb({type:lt,selectors:[["ntv-subscription-form"]],decls:18,vars:3,consts:[[1,"scrollbar"],[1,"form-container"],[1,"form",3,"formGroup"],["appearance","standard"],["formControlName","months","multiple",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","shipmentType"],["mat-flat-button","",3,"click"],[3,"value"]],template:function(t,e){1&t&&(C.Sb(0,"ng-scrollbar",0),C.Sb(1,"div",1),C.Sb(2,"h4"),C.zc(3,"\u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0438\u0440\u0443\u0435\u043c \u043f\u043e\u0434\u043f\u0438\u0441\u043a\u0443"),C.Rb(),C.Sb(4,"form",2),C.Sb(5,"mat-form-field",3),C.Sb(6,"mat-label"),C.zc(7,"\u041c\u0435\u0441\u044f\u0446\u044b"),C.Rb(),C.Sb(8,"mat-select",4),C.xc(9,ut,2,2,"mat-option",5),C.Rb(),C.Rb(),C.Sb(10,"mat-form-field",3),C.Sb(11,"mat-label"),C.zc(12,"\u041e\u0442\u043f\u0440\u0430\u0432\u043a\u0430"),C.Rb(),C.Sb(13,"mat-select",6),C.xc(14,bt,2,2,"mat-option",5),C.Rb(),C.Rb(),C.Sb(15,"button",7),C.Zb("click",function(){return e.showOrderStructureSelectionDialog()}),C.zc(16,"\u0421\u043e\u0441\u0442\u0430\u0432 \u0437\u0430\u043a\u0430\u0437\u0430"),C.Rb(),C.Rb(),C.Nb(17,"ntv-subscription-orders-form"),C.Rb(),C.Rb()),2&t&&(C.Bb(4),C.ic("formGroup",e.addSubscriptionForm),C.Bb(5),C.ic("ngForOf",e.months),C.Bb(5),C.ic("ngForOf",e.shipmentTypes))},directives:[q.a,z.v,z.o,z.h,M.c,M.f,W.a,z.n,z.g,$.j,T.a,st,D.n],styles:[".form[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);grid-gap:16px;height:100%;box-sizing:border-box}.form__order-structure-selector[_ngcontent-%COMP%]{cursor:pointer}.form-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px;padding:16px}.scrollbar[_ngcontent-%COMP%]{max-height:50vh}"]}),lt);function mt(t,e){if(1&t&&(C.Sb(0,"mat-option",17),C.zc(1),C.Rb()),2&t){var r=e.$implicit;C.ic("value",r.date),C.Bb(1),C.Bc(" ",r.name," ")}}function pt(t,e){if(1&t&&(C.Sb(0,"mat-option",17),C.zc(1),C.Rb()),2&t){var r=e.$implicit;C.ic("value",r),C.Bb(1),C.Bc(" ",r," ")}}function ft(t,e){if(1&t&&(C.Sb(0,"mat-option",17),C.zc(1),C.Rb()),2&t){var r=e.$implicit;C.ic("value",r),C.Bb(1),C.Bc(" ",r," ")}}function gt(t,e){if(1&t){var r=C.Tb();C.Sb(0,"mat-card",18),C.Sb(1,"mat-form-field",3),C.Sb(2,"mat-label"),C.zc(3,"\u0441\u043a\u043e\u043b\u044c\u043a\u043e"),C.Rb(),C.Nb(4,"input",19),C.Rb(),C.Sb(5,"button",14),C.Zb("click",function(){C.pc(r);var t=e.index;return C.dc().removeKit(t)}),C.Sb(6,"mat-icon"),C.zc(7,"delete"),C.Rb(),C.Rb(),C.Sb(8,"mat-form-field",3),C.Sb(9,"mat-label"),C.zc(10,"\u0432\u043e\u0437\u0440\u0430\u0441\u0442"),C.Rb(),C.Sb(11,"mat-select",20),C.xc(12,ft,2,2,"mat-option",8),C.Rb(),C.Rb(),C.Rb()}if(2&t){var n=e.$implicit,o=C.dc();C.Bb(4),C.ic("formControl",o.getControl(n.get("count"))),C.Bb(7),C.ic("formControl",o.getControl(n.get("age"))),C.Bb(1),C.ic("ngForOf",o.ages)}}function ht(t,e){if(1&t&&(C.Sb(0,"mat-option",22),C.zc(1),C.Rb()),2&t){var r=e.$implicit;C.ic("value",r),C.Bb(1),C.Bc(" ",r," ")}}function vt(t,e){if(1&t){var r=C.Tb();C.Sb(0,"mat-card",18),C.Sb(1,"mat-form-field",3),C.Sb(2,"mat-label"),C.zc(3,"\u0441\u043a\u043e\u043b\u044c\u043a\u043e"),C.Rb(),C.Nb(4,"input",19),C.Rb(),C.Sb(5,"button",14),C.Zb("click",function(){C.pc(r);var t=e.index;return C.dc().removeTheatre(t)}),C.Sb(6,"mat-icon"),C.zc(7,"delete"),C.Rb(),C.Rb(),C.Sb(8,"mat-form-field",3),C.Sb(9,"mat-label"),C.zc(10,"\u0432\u043e\u0437\u0440\u0430\u0441\u0442"),C.Rb(),C.Sb(11,"mat-select",20),C.xc(12,ht,2,2,"mat-option",21),C.Rb(),C.Rb(),C.Rb()}if(2&t){var n=e.$implicit,o=C.dc();C.Bb(4),C.ic("formControl",o.getControl(n.get("count"))),C.Bb(7),C.ic("formControl",o.getControl(n.get("age"))),C.Bb(1),C.ic("ngForOf",o.ages)}}var St,yt=((St=function(){function e(t,r){u(this,e),this.fb=t,this.store=r,this.months=et.a,this.ages=Object.values(_.a),this.shipmentTypes=Object.values(_.c),this.initialKitGroupState={age:_.a.twoThree,count:0},this.destroyer$$=new d.a}return l(e,[{key:"ngOnInit",value:function(){this.addOrderForm=this.fb.group({id:k.orders[0].id,personId:k.orders[0].personId,comment:k.orders[0].comment,sended:k.orders[0].sended,shipmentDate:k.orders[0].shipmentDate,shipmentType:k.orders[0].shipmentType,trackNumber:k.orders[0].trackNumber,type:k.orders[0].type,orderStructure:this.fb.group({kits:this.fb.array([]),theatres:this.fb.array([])})}),this.initFormSetter(),this.initFormSaver()}},{key:"ngOnDestroy",value:function(){this.destroyer$$.next(),this.destroyer$$.complete()}},{key:"initFormSaver",value:function(){var t=this;this.addOrderForm.valueChanges.pipe(Object(p.a)(this.destroyer$$),Object(f.a)(500)).subscribe(function(e){t.store.saveForm([e])})}},{key:"initFormSetter",value:function(){var t=this;this.store.select(function(t){return t.orders}).pipe(Object(p.a)(this.destroyer$$),Object(O.a)(function(e){if(e[0]&&!t.isOrdersEqual(t.addOrderForm.value,e[0])){t.setKitsAndTheatresControls(e[0]);var r=Object.assign({},e[0]);delete r.orderStructure,r.type=_.b.check,t.addOrderForm.patchValue(r)}})).subscribe()}},{key:"isOrdersEqual",value:function(t,e){var r=this.getDeepValues(Object.values(t)),n=this.getDeepValues(Object.values(e));return r.every(function(t){return n.includes(t)})}},{key:"getDeepValues",value:function(e){var r=this;return e.reduce(function(e,n){return"object"!=typeof n||null===n?e.push(n):Array.isArray(n)?e.push.apply(e,t(r.getDeepValues(n))):e.push.apply(e,t(r.getDeepValues(Object.values(n)))),e},[])}},{key:"addKit",value:function(t){this.kits.push(this.fb.group(t))}},{key:"addTheatre",value:function(t){this.theatres.push(this.fb.group(t))}},{key:"removeKit",value:function(t){this.kits.removeAt(t)}},{key:"removeTheatre",value:function(t){this.theatres.removeAt(t)}},{key:"getControl",value:function(t){return t}},{key:"setKitsAndTheatresControls",value:function(t){var e=this;t.orderStructure.kits.forEach(function(t){e.addKit(t)}),t.orderStructure.theatres.forEach(function(t){e.addTheatre(t)})}},{key:"kits",get:function(){return this.addOrderForm.get("orderStructure").get("kits")}},{key:"theatres",get:function(){return this.addOrderForm.get("orderStructure").get("theatres")}}]),e}()).\u0275fac=function(t){return new(t||St)(C.Mb(z.e),C.Mb(P))},St.\u0275cmp=C.Gb({type:St,selectors:[["ntv-once-form"]],decls:45,vars:7,consts:[[1,"scrollbar"],[1,"form",3,"formGroup"],[1,"form__comment"],["appearance","standard"],["matInput","","formControlName","comment"],[1,"form__block"],[1,"select-card"],["formControlName","shipmentDate"],[3,"value",4,"ngFor","ngForOf"],[3,"vertical"],["formControlName","shipmentType"],["formGroupName","orderStructure",1,"form__block"],["formArrayName","kits",1,"form__array"],[1,"form__array-title"],["mat-icon-button","","type","button",3,"click"],["class","form__array-item",4,"ngFor","ngForOf"],["formArrayName","theatres",1,"form__array"],[3,"value"],[1,"form__array-item"],["type","number","matInput","",3,"formControl"],[3,"formControl"],["name","dsfsd",3,"value",4,"ngFor","ngForOf"],["name","dsfsd",3,"value"]],template:function(t,e){1&t&&(C.Sb(0,"ng-scrollbar",0),C.Sb(1,"form",1),C.Sb(2,"h4"),C.zc(3,"\u041e \u0437\u0430\u043a\u0430\u0437\u0435"),C.Rb(),C.Sb(4,"mat-card",2),C.Sb(5,"mat-form-field",3),C.Sb(6,"mat-label"),C.zc(7,"\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439"),C.Rb(),C.Nb(8,"textarea",4),C.Rb(),C.Rb(),C.Sb(9,"h4"),C.zc(10,"\u041e\u0442\u043f\u0440\u0430\u0432\u043a\u0430"),C.Rb(),C.Sb(11,"div",5),C.Sb(12,"mat-card",6),C.Sb(13,"mat-form-field",3),C.Sb(14,"mat-label"),C.zc(15,"\u0414\u0430\u0442\u0430"),C.Rb(),C.Sb(16,"mat-select",7),C.xc(17,mt,2,2,"mat-option",8),C.Rb(),C.Rb(),C.Rb(),C.Nb(18,"mat-divider",9),C.Sb(19,"mat-card",6),C.Sb(20,"mat-form-field",3),C.Sb(21,"mat-label"),C.zc(22,"\u0422\u0438\u043f"),C.Rb(),C.Sb(23,"mat-select",10),C.xc(24,pt,2,2,"mat-option",8),C.Rb(),C.Rb(),C.Rb(),C.Rb(),C.Sb(25,"h4"),C.zc(26,"\u0427\u0442\u043e \u0432\u0435\u0437\u0435\u043c"),C.Rb(),C.Sb(27,"div",11),C.Sb(28,"div",12),C.Sb(29,"div",13),C.Sb(30,"h6"),C.zc(31,"\u041d\u0430\u0431\u043e\u0440\u044b"),C.Rb(),C.Sb(32,"button",14),C.Zb("click",function(){return e.addKit(e.initialKitGroupState)}),C.Sb(33,"mat-icon"),C.zc(34,"add"),C.Rb(),C.Rb(),C.Rb(),C.xc(35,gt,13,3,"mat-card",15),C.Rb(),C.Nb(36,"mat-divider",9),C.Sb(37,"div",16),C.Sb(38,"div",13),C.Sb(39,"h6"),C.zc(40,"\u0422\u0435\u0430\u0442\u0440\u044b"),C.Rb(),C.Sb(41,"button",14),C.Zb("click",function(){return e.addTheatre(e.initialKitGroupState)}),C.Sb(42,"mat-icon"),C.zc(43,"add"),C.Rb(),C.Rb(),C.Rb(),C.xc(44,vt,13,3,"mat-card",15),C.Rb(),C.Rb(),C.Rb(),C.Rb()),2&t&&(C.Bb(1),C.ic("formGroup",e.addOrderForm),C.Bb(16),C.ic("ngForOf",e.months),C.Bb(1),C.ic("vertical",!0),C.Bb(6),C.ic("ngForOf",e.shipmentTypes),C.Bb(11),C.ic("ngForOf",e.kits.controls),C.Bb(1),C.ic("vertical",!0),C.Bb(8),C.ic("ngForOf",e.theatres.controls))},directives:[q.a,z.v,z.o,z.h,Q.a,M.c,M.f,w.b,z.c,z.n,z.g,W.a,$.j,J.a,z.i,z.d,T.a,A.a,D.n,z.r,z.f],styles:["[_nghost-%COMP%]{display:block;min-width:500px}.form[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:16px;height:100%;padding:16px;box-sizing:border-box}.form__block[_ngcontent-%COMP%]{grid-template-columns:1fr 1px 1fr;grid-gap:16px}.form__block[_ngcontent-%COMP%], .form__comment[_ngcontent-%COMP%]{display:grid;width:100%}.form__array[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.form__array-item[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 40px;grid-template-rows:repeat(auto-fill,41px);grid-gap:16px}.form__array-title[_ngcontent-%COMP%]{display:flex;gap:16px;align-items:center}.scrollbar[_ngcontent-%COMP%]{max-height:50vh}.select-card[_ngcontent-%COMP%]{display:grid}"]}),St);function Ot(t,e){1&t&&C.Nb(0,"ntv-subscription-form",4)}function Rt(t,e){1&t&&C.Nb(0,"ntv-once-form",4)}var _t,kt=((_t=function(){function t(e){u(this,t),this.store=e}return l(t,[{key:"ngOnInit",value:function(){this.orders$=this.store.select(function(t){return t.orders})}}]),t}()).\u0275fac=function(t){return new(t||_t)(C.Mb(P))},_t.\u0275cmp=C.Gb({type:_t,selectors:[["ntv-order-form"]],decls:5,vars:0,consts:[["mat-stretch-tabs",""],["label","\u041f\u043e\u0434\u043f\u0438\u0441\u043a\u0430"],["matTabContent",""],["label","\u041f\u0440\u043e\u0431\u043d\u044b\u0439"],[1,"tabs__tab"]],template:function(t,e){1&t&&(C.Sb(0,"mat-tab-group",0),C.Sb(1,"mat-tab",1),C.xc(2,Ot,1,0,"ng-template",2),C.Rb(),C.Sb(3,"mat-tab",3),C.xc(4,Rt,1,0,"ng-template",2),C.Rb(),C.Rb())},directives:[Z.c,Z.a,Z.b,dt,yt],styles:["[_nghost-%COMP%]{display:block;margin:0 -24px -16px}.tabs__tab[_ngcontent-%COMP%]{min-height:50vh;display:block}"]}),_t),Ct=i("4Kj8");function xt(t,e){1&t&&(C.Sb(0,"span",5),C.zc(1," \u0421\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u043c... "),C.Nb(2,"ntv-spinner",6),C.Rb()),2&t&&(C.Bb(2),C.ic("diameter",16))}function Ft(t,e){1&t&&(C.Sb(0,"span",5),C.zc(1," \u041e\u0448\u0438\u0431\u043a\u0430, \u043d\u0430\u0436\u043c\u0438 \u0447\u0442\u043e\u0431\u044b \u043f\u043e\u043f\u0440\u043e\u0431\u043e\u0432\u0430\u0442\u044c \u0441\u043d\u043e\u0432\u0430 "),C.Sb(2,"mat-icon",7),C.zc(3,"error"),C.Rb(),C.Rb())}function Nt(t,e){1&t&&(C.Qb(0),C.zc(1," \u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0437\u0430\u043a\u0430\u0437 "),C.Pb())}function Bt(t,e){if(1&t){var r=C.Tb();C.Qb(0),C.Sb(1,"button",2),C.Zb("click",function(){C.pc(r);var t=e.ngIf;return C.dc().registerNewOrder(t)}),C.ec(2,"async"),C.xc(3,xt,3,1,"span",3),C.xc(4,Ft,4,0,"span",3),C.xc(5,Nt,2,0,"ng-container",4),C.Rb(),C.Pb()}if(2&t){var n=C.dc();C.Bb(1),C.ic("ngSwitch",C.fc(2,3,n.loadingState$)),C.Bb(2),C.ic("ngSwitchCase",n.loadingStates.loading),C.Bb(1),C.ic("ngSwitchCase",n.loadingStates.err)}}var Pt,jt,zt,Mt,wt=((Pt=function(){function t(e){u(this,t),this.store=e,this.loadingStates=v.a}return l(t,[{key:"ngOnInit",value:function(){this.store.setFormData(),this.loadingState$=this.store.select(function(t){return t.loadingState}).pipe(Object(f.a)(200)),this.state$=this.store.select(function(t){return t})}},{key:"registerNewOrder",value:function(t){this.store.registerNewOrder(t)}}]),t}()).\u0275fac=function(t){return new(t||Pt)(C.Mb(P))},Pt.\u0275cmp=C.Gb({type:Pt,selectors:[["ntv-add-order-dialog"]],features:[C.Ab([P])],decls:13,vars:3,consts:[["hideToggle",""],[4,"ngIf"],["mat-raised-button","",1,"submit-button",3,"ngSwitch","click"],["class","submit-button__content",4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"submit-button__content"],[1,"submit-button__spinner",3,"diameter"],[1,"submit-button__error-icon"]],template:function(t,e){1&t&&(C.Sb(0,"mat-accordion"),C.Sb(1,"mat-expansion-panel",0),C.Sb(2,"mat-expansion-panel-header"),C.Sb(3,"mat-panel-title"),C.zc(4," \u041a\u043b\u0438\u0435\u043d\u0442 "),C.Rb(),C.Rb(),C.Nb(5,"ntv-customer-form"),C.Rb(),C.Sb(6,"mat-expansion-panel",0),C.Sb(7,"mat-expansion-panel-header"),C.Sb(8,"mat-panel-title"),C.zc(9," \u0417\u0430\u043a\u0430\u0437 "),C.Rb(),C.Rb(),C.Nb(10,"ntv-order-form"),C.Rb(),C.Rb(),C.xc(11,Bt,6,5,"ng-container",1),C.ec(12,"async")),2&t&&(C.Bb(11),C.ic("ngIf",C.fc(12,1,e.state$)))},directives:[j.a,j.c,j.f,j.g,K,kt,$.k,T.a,$.m,$.n,$.o,Ct.a,A.a],pipes:[$.b],styles:["[_nghost-%COMP%]{flex-direction:column;gap:16px}.submit-button__content[_ngcontent-%COMP%], [_nghost-%COMP%]{display:flex;align-items:center}.submit-button__spinner[_ngcontent-%COMP%]{margin-top:0;margin-left:8px}.submit-button__error-icon[_ngcontent-%COMP%]{margin-left:8px}"]}),Pt),It=i("l7P3"),$t=((jt=function(){function t(e,r,n){u(this,t),this.data=e,this.fb=r,this.store=n}return l(t,[{key:"ngOnInit",value:function(){this.editPersonForm=this.fb.group({name:this.data.person.name,email:this.data.person.contacts.email||"",inst:this.data.person.contacts.inst||"",phone:this.data.person.contacts.phone||"",city:this.data.person.address.city,address:this.data.person.address.address})}},{key:"patchPerson",value:function(){var t,e,r,n,o,i,a={id:this.data.person.id,_id:this.data.person._id,name:null===(t=this.editPersonForm.get("name"))||void 0===t?void 0:t.value,contacts:{email:null===(e=this.editPersonForm.get("email"))||void 0===e?void 0:e.value,inst:null===(r=this.editPersonForm.get("inst"))||void 0===r?void 0:r.value,phone:null===(n=this.editPersonForm.get("phone"))||void 0===n?void 0:n.value},address:{city:null===(o=this.editPersonForm.get("city"))||void 0===o?void 0:o.value,address:null===(i=this.editPersonForm.get("address"))||void 0===i?void 0:i.value}};this.store.dispatch(h.a.patchPending({customer:a}))}}]),t}()).\u0275fac=function(t){return new(t||jt)(C.Mb(B.a),C.Mb(z.e),C.Mb(It.h))},jt.\u0275cmp=C.Gb({type:jt,selectors:[["ntv-edit-person-dialog"]],decls:27,vars:1,consts:[[1,"form",3,"formGroup","ngSubmit"],["appearance","standard"],["matInput","","formControlName","name"],["matInput","","formControlName","email"],["matInput","","formControlName","inst"],["matInput","","formControlName","phone"],["matInput","","formControlName","city"],["matInput","","formControlName","address"],["mat-flat-button","","type","submit"]],template:function(t,e){1&t&&(C.Sb(0,"form",0),C.Zb("ngSubmit",function(){return e.patchPerson()}),C.Sb(1,"mat-form-field",1),C.Sb(2,"mat-label"),C.zc(3,"\u0424\u0418\u041e"),C.Rb(),C.Nb(4,"input",2),C.Rb(),C.Sb(5,"mat-form-field",1),C.Sb(6,"mat-label"),C.zc(7,"E-mail"),C.Rb(),C.Nb(8,"input",3),C.Rb(),C.Sb(9,"mat-form-field",1),C.Sb(10,"mat-label"),C.zc(11,"\u0418\u043d\u0441\u0442\u0430\u0433\u0440\u0430\u043c"),C.Rb(),C.Nb(12,"input",4),C.Rb(),C.Sb(13,"mat-form-field",1),C.Sb(14,"mat-label"),C.zc(15,"\u0422\u0435\u043b\u0435\u0444\u043e\u043d"),C.Rb(),C.Nb(16,"input",5),C.Rb(),C.Sb(17,"mat-form-field",1),C.Sb(18,"mat-label"),C.zc(19,"\u0413\u043e\u0440\u043e\u0434"),C.Rb(),C.Nb(20,"input",6),C.Rb(),C.Sb(21,"mat-form-field",1),C.Sb(22,"mat-label"),C.zc(23,"\u041e\u0441\u0442\u0430\u043b\u044c\u043d\u043e\u0439 \u0430\u0434\u0440\u0435\u0441"),C.Rb(),C.Nb(24,"input",7),C.Rb(),C.Sb(25,"button",8),C.zc(26,"\u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c"),C.Rb(),C.Rb()),2&t&&C.ic("formGroup",e.editPersonForm)},directives:[z.v,z.o,z.h,M.c,M.f,w.b,z.c,z.n,z.g,T.a],styles:["[_nghost-%COMP%]{display:block;min-width:500px}.form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}"]}),jt),Tt=i("+PC+"),At=i("UXJo"),Dt=i("hS0P"),Gt=((zt=function(e){o(n,e);var r=a(n);function n(e){var o;return u(this,n),(o=r.call(this,Et)).ordersService=e,o.getOrders=o.effect(function(t){return t.pipe(Object(g.a)(function(t){return o.addOrdersPending(),o.ordersService.getOrders(t).pipe(Object(O.a)(function(t){console.log(t),o.addOrdersSuccess(t)}),Object(R.a)(function(t){return o.addOrdersError(),Object(y.a)(t)}))}))}),o.patchOrder=o.updater(function(t,e){var r=t.orders.slice();return r[r.findIndex(function(t){return t.id===e.id})]=Object.assign({},e),Object.assign(Object.assign({},t),{orders:r})}),o.addOrdersPending=o.updater(function(t){return Object.assign(Object.assign({},t),{loading:!0})}),o.addOrdersSuccess=o.updater(function(e,r){return{orders:[].concat(t(e.orders),t(r)),loading:!1,err:!1}}),o.addOrdersError=o.updater(function(t){return Object.assign(Object.assign({},t),{err:!0,loading:!1})}),o}return n}(S.a)).\u0275fac=function(t){return new(t||zt)(C.Wb(Dt.a))},zt.\u0275prov=C.Ib({token:zt,factory:zt.\u0275fac}),zt),Et={orders:[],loading:!1,err:!1},Kt=i("wJZa"),Zt=((Mt=function t(){u(this,t)}).\u0275fac=function(t){return new(t||Mt)},Mt.\u0275cmp=C.Gb({type:Mt,selectors:[["ntv-kit"]],inputs:{kit:"kit"},decls:3,vars:6,consts:[[3,"overline","value"]],template:function(t,e){1&t&&(C.Nb(0,"ntv-overlined",0),C.Nb(1,"ntv-overlined",0),C.ec(2,"numberToString")),2&t&&(C.ic("overline","\u0432\u043e\u0437\u0440\u0430\u0441\u0442")("value",e.kit.age),C.Bb(1),C.ic("overline","\u0441\u043a\u043e\u043b\u044c\u043a\u043e")("value",C.fc(2,4,e.kit.count)))},directives:[rt.a],pipes:[Kt.a],styles:["[_nghost-%COMP%]{display:flex;gap:16px}"]}),Mt);function Vt(t,e){1&t&&C.Nb(0,"ntv-kit",4),2&t&&C.ic("kit",e.$implicit)}function qt(t,e){1&t&&C.Nb(0,"ntv-kit",4),2&t&&C.ic("kit",e.$implicit)}var Jt,Qt=((Jt=function t(e){u(this,t),this.data=e}).\u0275fac=function(t){return new(t||Jt)(C.Mb(B.a))},Jt.\u0275cmp=C.Gb({type:Jt,selectors:[["ntv-order-structure-dialog"]],decls:9,vars:3,consts:[[1,"kits"],[3,"kit",4,"ngFor","ngForOf"],[3,"vertical"],[1,"theatres"],[3,"kit"]],template:function(t,e){1&t&&(C.Sb(0,"div",0),C.Sb(1,"h6"),C.zc(2,"\u041d\u0430\u0431\u043e\u0440\u044b"),C.Rb(),C.xc(3,Vt,1,1,"ntv-kit",1),C.Rb(),C.Nb(4,"mat-divider",2),C.Sb(5,"div",3),C.Sb(6,"h6"),C.zc(7,"\u0422\u0435\u0430\u0442\u0440\u044b"),C.Rb(),C.xc(8,qt,1,1,"ntv-kit",1),C.Rb()),2&t&&(C.Bb(3),C.ic("ngForOf",e.data.orderStructure.kits),C.Bb(1),C.ic("vertical",!0),C.Bb(4),C.ic("ngForOf",e.data.orderStructure.theatres))},directives:[$.j,J.a,Zt],styles:["[_nghost-%COMP%]{display:grid;grid-template-columns:1fr 1px 1fr;grid-template-rows:repeat(auto-fill,100px);grid-gap:16px}"]}),Jt),Wt=i("bSwM");function Ht(t,e){if(1&t&&(C.Sb(0,"mat-option",22),C.zc(1),C.Rb()),2&t){var r=e.$implicit;C.ic("value",r),C.Bb(1),C.Bc(" ",r," ")}}function Xt(t,e){if(1&t&&(C.Sb(0,"mat-option",22),C.zc(1),C.Rb()),2&t){var r=e.$implicit;C.ic("value",r.date),C.Bb(1),C.Bc(" ",r.name," ")}}function Ut(t,e){if(1&t&&(C.Sb(0,"mat-option",22),C.zc(1),C.Rb()),2&t){var r=e.$implicit;C.ic("value",r),C.Bb(1),C.Bc(" ",r," ")}}function Lt(t,e){if(1&t&&(C.Sb(0,"mat-option",22),C.zc(1),C.Rb()),2&t){var r=e.$implicit;C.ic("value",r),C.Bb(1),C.Bc(" ",r," ")}}function Yt(t,e){if(1&t){var r=C.Tb();C.Sb(0,"mat-card",23),C.Sb(1,"mat-form-field",4),C.Sb(2,"mat-label"),C.zc(3,"\u0441\u043a\u043e\u043b\u044c\u043a\u043e"),C.Rb(),C.Nb(4,"input",24),C.Rb(),C.Sb(5,"button",16),C.Zb("click",function(){C.pc(r);var t=e.index;return C.dc().removeKit(t)}),C.Sb(6,"mat-icon"),C.zc(7,"delete"),C.Rb(),C.Rb(),C.Sb(8,"mat-form-field",4),C.Sb(9,"mat-label"),C.zc(10,"\u0432\u043e\u0437\u0440\u0430\u0441\u0442"),C.Rb(),C.Sb(11,"mat-select",25),C.xc(12,Lt,2,2,"mat-option",10),C.Rb(),C.Rb(),C.Rb()}if(2&t){var n=e.$implicit,o=C.dc();C.Bb(4),C.ic("formControl",o.getControl(n.get("count"))),C.Bb(7),C.ic("formControl",o.getControl(n.get("age"))),C.Bb(1),C.ic("ngForOf",o.ages)}}function te(t,e){if(1&t&&(C.Sb(0,"mat-option",27),C.zc(1),C.Rb()),2&t){var r=e.$implicit;C.ic("value",r),C.Bb(1),C.Bc(" ",r," ")}}function ee(t,e){if(1&t){var r=C.Tb();C.Sb(0,"mat-card",23),C.Sb(1,"mat-form-field",4),C.Sb(2,"mat-label"),C.zc(3,"\u0441\u043a\u043e\u043b\u044c\u043a\u043e"),C.Rb(),C.Nb(4,"input",24),C.Rb(),C.Sb(5,"button",16),C.Zb("click",function(){C.pc(r);var t=e.index;return C.dc().removeTheatre(t)}),C.Sb(6,"mat-icon"),C.zc(7,"delete"),C.Rb(),C.Rb(),C.Sb(8,"mat-form-field",4),C.Sb(9,"mat-label"),C.zc(10,"\u0432\u043e\u0437\u0440\u0430\u0441\u0442"),C.Rb(),C.Sb(11,"mat-select",25),C.xc(12,te,2,2,"mat-option",26),C.Rb(),C.Rb(),C.Rb()}if(2&t){var n=e.$implicit,o=C.dc();C.Bb(4),C.ic("formControl",o.getControl(n.get("count"))),C.Bb(7),C.ic("formControl",o.getControl(n.get("age"))),C.Bb(1),C.ic("ngForOf",o.ages)}}function re(t,e){1&t&&(C.Sb(0,"span",28),C.zc(1," \u0421\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u043c... "),C.Nb(2,"ntv-spinner",29),C.Rb()),2&t&&(C.Bb(2),C.ic("diameter",16))}function ne(t,e){1&t&&(C.Sb(0,"span",28),C.zc(1," \u041e\u0448\u0438\u0431\u043a\u0430, \u043d\u0430\u0436\u043c\u0438 \u0447\u0442\u043e\u0431\u044b \u043f\u043e\u043f\u0440\u043e\u0431\u043e\u0432\u0430\u0442\u044c \u0441\u043d\u043e\u0432\u0430 "),C.Sb(2,"mat-icon",30),C.zc(3,"error"),C.Rb(),C.Rb())}function oe(t,e){1&t&&(C.Qb(0),C.zc(1," \u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c "),C.Pb())}var ie,ae=((ie=function(){function t(e,r,n,o){u(this,t),this.dialogRef=e,this.order=r,this.fb=n,this.ordersService=o,this.loadingStates=v.a,this.months=et.a,this.ages=Object.values(_.a),this.orderTypes=Object.values(_.b),this.shipmentTypes=Object.values(_.c),this.initialKitGroupState={age:_.a.twoThree,count:0}}return l(t,[{key:"ngOnInit",value:function(){this.editOrderForm=this.fb.group({comment:this.order.comment,sended:this.order.sended,shipmentDate:this.order.shipmentDate,shipmentType:this.order.shipmentType,trackNumber:this.order.trackNumber,type:this.order.type,orderStructure:this.fb.group({kits:this.fb.array([]),theatres:this.fb.array([])})}),this.initKitsAndTheatresControls()}},{key:"patchOrder",value:function(){var t=this,e=Object.assign({id:this.order.id,personId:this.order.personId},this.editOrderForm.value);this.loadingState=this.loadingStates.loading,this.ordersService.patchOrder(e).pipe(Object(O.a)(function(e){t.loadingState=null,t.dialogRef.close(e)}),Object(R.a)(function(e){return t.loadingState=t.loadingStates.err,Object(y.a)(e)})).subscribe()}},{key:"addKit",value:function(t){this.kits.push(this.fb.group(t))}},{key:"addTheatre",value:function(t){this.theatres.push(this.fb.group(t))}},{key:"removeKit",value:function(t){this.kits.removeAt(t)}},{key:"removeTheatre",value:function(t){this.theatres.removeAt(t)}},{key:"getControl",value:function(t){return t}},{key:"initKitsAndTheatresControls",value:function(){var t=this;this.order.orderStructure.kits.forEach(function(e){t.addKit(e)}),this.order.orderStructure.theatres.forEach(function(e){t.addTheatre(e)})}},{key:"kits",get:function(){return this.editOrderForm.get("orderStructure").get("kits")}},{key:"theatres",get:function(){return this.editOrderForm.get("orderStructure").get("theatres")}}]),t}()).\u0275fac=function(t){return new(t||ie)(C.Mb(B.d),C.Mb(B.a),C.Mb(z.e),C.Mb(Dt.a))},ie.\u0275cmp=C.Gb({type:ie,selectors:[["ntv-edit-order-dialog"]],decls:61,vars:12,consts:[[1,"scrollbar"],[1,"form",3,"formGroup","ngSubmit"],[1,"form__block"],[1,"select-card"],["appearance","standard"],["matInput","","formControlName","comment"],[3,"vertical"],[1,"form__block-colomn"],["formControlName","sended"],["formControlName","type"],[3,"value",4,"ngFor","ngForOf"],["formControlName","shipmentDate"],["formControlName","shipmentType"],["formGroupName","orderStructure",1,"form__block"],["formArrayName","kits",1,"form__array"],[1,"form__array-title"],["mat-icon-button","","type","button",3,"click"],["class","form__array-item",4,"ngFor","ngForOf"],["formArrayName","theatres",1,"form__array"],["mat-raised-button","","type","submit",1,"submit-button",3,"ngSwitch"],["class","submit-button__content",4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"value"],[1,"form__array-item"],["type","number","matInput","",3,"formControl"],[3,"formControl"],["name","dsfsd",3,"value",4,"ngFor","ngForOf"],["name","dsfsd",3,"value"],[1,"submit-button__content"],[1,"submit-button__spinner",3,"diameter"],[1,"submit-button__error-icon"]],template:function(t,e){1&t&&(C.Sb(0,"ng-scrollbar",0),C.Sb(1,"form",1),C.Zb("ngSubmit",function(){return e.patchOrder()}),C.Sb(2,"h4"),C.zc(3,"\u041e \u0437\u0430\u043a\u0430\u0437\u0435"),C.Rb(),C.Sb(4,"div",2),C.Sb(5,"mat-card",3),C.Sb(6,"mat-form-field",4),C.Sb(7,"mat-label"),C.zc(8,"\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439"),C.Rb(),C.Nb(9,"textarea",5),C.Rb(),C.Rb(),C.Nb(10,"mat-divider",6),C.Sb(11,"div",7),C.Sb(12,"mat-card",3),C.Sb(13,"mat-checkbox",8),C.zc(14,"\u041e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043e"),C.Rb(),C.Rb(),C.Sb(15,"mat-card",3),C.Sb(16,"mat-form-field",4),C.Sb(17,"mat-label"),C.zc(18,"\u0422\u0438\u043f"),C.Rb(),C.Sb(19,"mat-select",9),C.xc(20,Ht,2,2,"mat-option",10),C.Rb(),C.Rb(),C.Rb(),C.Rb(),C.Rb(),C.Sb(21,"h4"),C.zc(22,"\u041e\u0442\u043f\u0440\u0430\u0432\u043a\u0430"),C.Rb(),C.Sb(23,"div",2),C.Sb(24,"mat-card",3),C.Sb(25,"mat-form-field",4),C.Sb(26,"mat-label"),C.zc(27,"\u0414\u0430\u0442\u0430"),C.Rb(),C.Sb(28,"mat-select",11),C.xc(29,Xt,2,2,"mat-option",10),C.Rb(),C.Rb(),C.Rb(),C.Nb(30,"mat-divider",6),C.Sb(31,"mat-card",3),C.Sb(32,"mat-form-field",4),C.Sb(33,"mat-label"),C.zc(34,"\u0422\u0438\u043f"),C.Rb(),C.Sb(35,"mat-select",12),C.xc(36,Ut,2,2,"mat-option",10),C.Rb(),C.Rb(),C.Rb(),C.Rb(),C.Sb(37,"h4"),C.zc(38,"\u0427\u0442\u043e \u0432\u0435\u0437\u0435\u043c"),C.Rb(),C.Sb(39,"div",13),C.Sb(40,"div",14),C.Sb(41,"div",15),C.Sb(42,"h6"),C.zc(43,"\u041d\u0430\u0431\u043e\u0440\u044b"),C.Rb(),C.Sb(44,"button",16),C.Zb("click",function(){return e.addKit(e.initialKitGroupState)}),C.Sb(45,"mat-icon"),C.zc(46,"add"),C.Rb(),C.Rb(),C.Rb(),C.xc(47,Yt,13,3,"mat-card",17),C.Rb(),C.Nb(48,"mat-divider",6),C.Sb(49,"div",18),C.Sb(50,"div",15),C.Sb(51,"h6"),C.zc(52,"\u0422\u0435\u0430\u0442\u0440\u044b"),C.Rb(),C.Sb(53,"button",16),C.Zb("click",function(){return e.addTheatre(e.initialKitGroupState)}),C.Sb(54,"mat-icon"),C.zc(55,"add"),C.Rb(),C.Rb(),C.Rb(),C.xc(56,ee,13,3,"mat-card",17),C.Rb(),C.Rb(),C.Sb(57,"button",19),C.xc(58,re,3,1,"span",20),C.xc(59,ne,4,0,"span",20),C.xc(60,oe,2,0,"ng-container",21),C.Rb(),C.Rb(),C.Rb()),2&t&&(C.Bb(1),C.ic("formGroup",e.editOrderForm),C.Bb(9),C.ic("vertical",!0),C.Bb(10),C.ic("ngForOf",e.orderTypes),C.Bb(9),C.ic("ngForOf",e.months),C.Bb(1),C.ic("vertical",!0),C.Bb(6),C.ic("ngForOf",e.shipmentTypes),C.Bb(11),C.ic("ngForOf",e.kits.controls),C.Bb(1),C.ic("vertical",!0),C.Bb(8),C.ic("ngForOf",e.theatres.controls),C.Bb(1),C.ic("ngSwitch",e.loadingState),C.Bb(1),C.ic("ngSwitchCase",e.loadingStates.loading),C.Bb(1),C.ic("ngSwitchCase",e.loadingStates.err))},directives:[q.a,z.v,z.o,z.h,Q.a,M.c,M.f,w.b,z.c,z.n,z.g,J.a,Wt.a,W.a,$.j,z.i,z.d,T.a,A.a,$.m,$.n,$.o,D.n,z.r,z.f,Ct.a],styles:["[_nghost-%COMP%]{display:block;min-width:500px;margin:-24px}.form[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:16px;width:100%;height:100%;padding:16px}.form__block[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1px 1fr;grid-gap:16px;width:100%}.form__block-colomn[_ngcontent-%COMP%]{width:100%}.form__array[_ngcontent-%COMP%], .form__block-colomn[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.form__array-item[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 40px;grid-template-rows:repeat(auto-fill,41px);grid-gap:16px}.form__array-title[_ngcontent-%COMP%]{gap:16px}.form__array-title[_ngcontent-%COMP%], .submit-button__content[_ngcontent-%COMP%]{display:flex;align-items:center}.submit-button__spinner[_ngcontent-%COMP%]{margin-top:0;margin-left:8px}.submit-button__error-icon[_ngcontent-%COMP%]{margin-left:8px}.scrollbar[_ngcontent-%COMP%]{max-height:90vh}.select-card[_ngcontent-%COMP%]{display:grid}"]}),ie),ce=i("hA4r"),se=i("8prF");function ue(t,e){if(1&t){var r=C.Tb();C.Sb(0,"ntv-overlined",9),C.Zb("click",function(){return C.pc(r),C.dc().showOrderStructureDialog()}),C.Rb()}2&t&&C.ic("overline","\u043d\u0430\u0431\u043e\u0440\u044b")("value","\u043d\u0430\u0436\u043c\u0438 \u0434\u043b\u044f \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430")}function be(t,e){if(1&t&&(C.Qb(0),C.Nb(1,"ntv-overlined",11),C.Nb(2,"ntv-kit",12),C.Pb()),2&t){var r=C.dc(2);C.Bb(2),C.ic("kit",r.order.orderStructure.kits[0])}}function le(t,e){if(1&t&&(C.Qb(0),C.Nb(1,"ntv-overlined",13),C.Nb(2,"ntv-kit",12),C.Pb()),2&t){var r=C.dc(2);C.Bb(2),C.ic("kit",r.order.orderStructure.theatres[0])}}function de(t,e){if(1&t&&(C.xc(0,be,3,1,"ng-container",10),C.xc(1,le,3,1,"ng-container",10)),2&t){var r=C.dc();C.ic("ngIf",r.order.orderStructure.kits.length),C.Bb(1),C.ic("ngIf",r.order.orderStructure.theatres.length)}}var me,pe=((me=function(){function t(e,r,n){u(this,t),this.dialog=e,this.ordersStore=r,this.clipService=n}return l(t,[{key:"showOrderStructureDialog",value:function(){this.dialog.open(Qt,{data:{orderStructure:this.order.orderStructure}})}},{key:"showEditor",value:function(){var t=this;this.dialog.open(ae,{data:this.order}).afterClosed().subscribe(function(e){e&&t.ordersStore.patchOrder(e)})}},{key:"moreThanOneKit",get:function(){var t=this.order.orderStructure.kits.length,e=this.order.orderStructure.theatres.length;return t>1||e>1||t>0&&e>0}}]),t}()).\u0275fac=function(t){return new(t||me)(C.Mb(B.b),C.Mb(Gt),C.Mb(Tt.a))},me.\u0275cmp=C.Gb({type:me,selectors:[["ntv-person-order"]],inputs:{order:"order"},decls:14,vars:14,consts:[[1,"order"],[1,"order__data"],[3,"overline","value"],["class","order__kits",3,"overline","value","click",4,"ngIf","ngIfElse"],["oneKit",""],[3,"orderId","sendedStatus"],[3,"orderId","trackNumber"],[1,"order__comment",3,"overline","value"],["mat-icon-button","",1,"order__edit",3,"click"],[1,"order__kits",3,"overline","value","click"],[4,"ngIf"],["overline","\u0447\u0442\u043e \u043f\u0440\u0438\u0432\u0435\u0437\u0442\u0438","value","\u043d\u0430\u0431\u043e\u0440"],[3,"kit"],["overline","\u0447\u0442\u043e \u043f\u0440\u0438\u0432\u0435\u0437\u0442\u0438","value","\u0442\u0435\u0430\u0442\u0440"]],template:function(t,e){if(1&t&&(C.Sb(0,"mat-card",0),C.Sb(1,"div",1),C.Nb(2,"ntv-overlined",2),C.Nb(3,"ntv-overlined",2),C.Nb(4,"ntv-overlined",2),C.xc(5,ue,1,2,"ntv-overlined",3),C.xc(6,de,2,2,"ng-template",null,4,C.yc),C.Nb(8,"ntv-sended-checkbox",5),C.Nb(9,"ntv-track-field",6),C.Rb(),C.Nb(10,"ntv-overlined",7),C.Sb(11,"button",8),C.Zb("click",function(){return e.showEditor()}),C.Sb(12,"mat-icon"),C.zc(13,"edit"),C.Rb(),C.Rb(),C.Rb()),2&t){var r=C.nc(7);C.Bb(2),C.ic("overline","\u0442\u0438\u043f \u0437\u0430\u043a\u0430\u0437\u0430")("value",e.order.type),C.Bb(1),C.ic("overline","\u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c")("value",e.order.shipmentDate),C.Bb(1),C.ic("overline","\u043f\u043e\u0432\u0435\u0437\u0435\u0442")("value",e.order.shipmentType||"\u043d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d"),C.Bb(1),C.ic("ngIf",e.moreThanOneKit)("ngIfElse",r),C.Bb(3),C.ic("orderId",e.order.id)("sendedStatus",e.order.sended),C.Bb(1),C.ic("orderId",e.order.id)("trackNumber",e.order.trackNumber),C.Bb(1),C.ic("overline","\u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439")("value",e.order.comment||"\u043d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d")}},directives:[Q.a,rt.a,$.k,ce.a,se.a,T.a,A.a,Zt],styles:['[_nghost-%COMP%]{display:block}.order[_ngcontent-%COMP%]{display:grid;grid-template-areas:"data edit" "comment comment";grid-template-columns:1fr 40px;grid-template-rows:auto auto;grid-gap:8px}.order__data[_ngcontent-%COMP%]{display:flex;gap:16px;flex-wrap:wrap;grid-area:data}.order__comment[_ngcontent-%COMP%]{grid-area:comment}.order__edit[_ngcontent-%COMP%]{grid-area:edit}.order__kits[_ngcontent-%COMP%]{cursor:pointer}.order__track-control-spinner[_ngcontent-%COMP%]{margin-top:16px}.order__track-copy-icon[_ngcontent-%COMP%]{cursor:pointer}']}),me);function fe(t,e){1&t&&C.Nb(0,"ntv-person-order",4),2&t&&C.ic("order",e.$implicit)}function ge(t,e){1&t&&(C.Sb(0,"p"),C.zc(1,"\u0423 \u043a\u043b\u0438\u0435\u043d\u0442\u0430 \u043d\u0435\u0442 \u0437\u0430\u043a\u0430\u0437\u043e\u0432"),C.Rb())}function he(t,e){if(1&t){var r=C.Tb();C.Sb(0,"p"),C.zc(1,"\u041e\u0448\u0438\u0431\u043a\u0430, \u043f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 "),C.Sb(2,"span",5),C.Zb("click",function(){return C.pc(r),C.dc(2).getOrders()}),C.zc(3,"\u0435\u0449\u0435 \u0440\u0430\u0437"),C.Rb(),C.Rb()}}function ve(t,e){1&t&&C.Nb(0,"ntv-spinner",6),2&t&&C.ic("diameter",24)}function Se(t,e){if(1&t&&(C.Qb(0),C.Sb(1,"mat-accordion"),C.xc(2,fe,1,1,"ntv-person-order",1),C.xc(3,ge,2,0,"p",0),C.Rb(),C.xc(4,he,4,0,"p",0),C.Nb(5,"div",2),C.xc(6,ve,1,1,"ntv-spinner",3),C.Pb()),2&t){var r=e.ngIf;C.Bb(2),C.ic("ngForOf",r.orders),C.Bb(1),C.ic("ngIf",!r.orders.length&&!r.err&&!r.loading),C.Bb(1),C.ic("ngIf",r.err),C.Bb(2),C.ic("ngIf",r.loading)}}var ye,Oe=((ye=function(){function t(e){u(this,t),this.ordersStore=e}return l(t,[{key:"ngOnInit",value:function(){this.state$=this.ordersStore.select(function(t){return t}),this.getOrders()}},{key:"getOrders",value:function(){this.ordersStore.getOrders(this.personId)}}]),t}()).\u0275fac=function(t){return new(t||ye)(C.Mb(Gt))},ye.\u0275cmp=C.Gb({type:ye,selectors:[["ntv-person-orders"]],inputs:{personId:"personId"},features:[C.Ab([Gt])],decls:2,vars:3,consts:[[4,"ngIf"],["class","order",3,"order",4,"ngFor","ngForOf"],["if",""],[3,"diameter",4,"ngIf"],[1,"order",3,"order"],[1,"text-button",3,"click"],[3,"diameter"]],template:function(t,e){1&t&&(C.xc(0,Se,7,4,"ng-container",0),C.ec(1,"async")),2&t&&C.ic("ngIf",C.fc(1,1,e.state$))},directives:[$.k,j.a,$.j,pe,Ct.a],pipes:[$.b],styles:[".text-button[_ngcontent-%COMP%]{color:red;cursor:pointer}.order[_ngcontent-%COMP%]{margin-bottom:8px}"]}),ye);function Re(t,e){if(1&t&&C.Nb(0,"ntv-overlined",6),2&t){var r=e.$implicit;C.ic("clip",r.value)("overline",r.name)("value",r.value||"\u043d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d")}}function _e(t,e){if(1&t&&(C.Sb(0,"div",7),C.Sb(1,"h6",8),C.zc(2,"\u0410\u0434\u0440\u0435\u0441"),C.Rb(),C.Nb(3,"ntv-overlined",9),C.Nb(4,"ntv-overlined",10),C.Rb(),C.Sb(5,"h6"),C.zc(6,"\u0417\u0430\u043a\u0430\u0437\u044b"),C.Rb(),C.Nb(7,"ntv-person-orders",11)),2&t){var r=C.dc();C.Bb(3),C.ic("clip",r.person.address.city)("value",r.person.address.city||"\u043d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d"),C.Bb(1),C.ic("clip",r.person.address.address)("value",r.person.address.address||"\u043d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d"),C.Bb(3),C.ic("personId",r.person.id)}}var ke,Ce=((ke=function(){function t(e,r){u(this,t),this.clipService=e,this.dialog=r}return l(t,[{key:"ngOnInit",value:function(){this.contactItems=[{name:"\u041f\u043e\u0447\u0442\u0430",value:this.person.contacts.email||"\u041d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d"},{name:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d",value:this.person.contacts.phone||"\u041d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d"},{name:"\u0418\u043d\u0441\u0442\u0430\u0433\u0440\u0430\u043c",value:this.person.contacts.inst||"\u041d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d"}]}},{key:"showEditor",value:function(){this.dialog.open($t,{data:{person:this.person}})}}]),t}()).\u0275fac=function(t){return new(t||ke)(C.Mb(Tt.a),C.Mb(B.b))},ke.\u0275cmp=C.Gb({type:ke,selectors:[["ntv-person"]],inputs:{person:"person"},decls:10,vars:3,consts:[[1,"person"],[1,"person__title",3,"cdkCopyToClipboard","cdkCopyToClipboardCopied","click"],[1,"person__description",3,"click"],["class","person__address-item",3,"clip","overline","value",4,"ngFor","ngForOf"],["mat-icon-button","",3,"click"],["matExpansionPanelContent",""],[1,"person__address-item",3,"clip","overline","value"],[1,"person__address"],[1,"person__address-title"],["overline","\u0433\u043e\u0440\u043e\u0434",1,"person__address-item",3,"clip","value"],["overline","\u043e\u0441\u0442\u0430\u043b\u044c\u043d\u043e\u0435",1,"person__address-item",3,"clip","value"],[3,"personId"]],template:function(t,e){1&t&&(C.Sb(0,"mat-expansion-panel",0),C.Sb(1,"mat-expansion-panel-header"),C.Sb(2,"mat-panel-title",1),C.Zb("cdkCopyToClipboardCopied",function(){return e.clipService.clip(e.person.name)})("click",function(t){return t.stopPropagation()}),C.zc(3),C.Rb(),C.Sb(4,"mat-panel-description",2),C.Zb("click",function(t){return t.stopPropagation()}),C.xc(5,Re,1,3,"ntv-overlined",3),C.Sb(6,"button",4),C.Zb("click",function(){return e.showEditor()}),C.Sb(7,"mat-icon"),C.zc(8,"edit"),C.Rb(),C.Rb(),C.Rb(),C.Rb(),C.xc(9,_e,8,5,"ng-template",5),C.Rb()),2&t&&(C.Bb(2),C.ic("cdkCopyToClipboard",e.person.name),C.Bb(1),C.Bc(" ",e.person.name," "),C.Bb(2),C.ic("ngForOf",e.contactItems))},directives:[j.c,j.f,j.g,At.a,j.e,$.j,T.a,A.a,j.d,rt.a,Oe],styles:['[_nghost-%COMP%]{display:block;overflow:hidden}.person__title[_ngcontent-%COMP%]{min-width:200px;max-width:200px}.person__description[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr) auto;grid-gap:16px}.person__address[_ngcontent-%COMP%]{display:grid;grid-template-areas:"title title" "item item";grid-template-columns:auto auto;grid-template-rows:auto auto}.person__address-title[_ngcontent-%COMP%]{grid-area:title}.person__address-item[_ngcontent-%COMP%]{cursor:pointer}.person.mat-expansion-panel[_ngcontent-%COMP%]{border-radius:0!important}']}),ke);function xe(t,e){if(1&t&&(C.Sb(0,"mat-option",10),C.zc(1),C.Rb()),2&t){var r=e.$implicit;C.ic("value",r),C.Bb(1),C.Bc(" ",r.name," ")}}function Fe(t,e){1&t&&C.Nb(0,"ntv-spinner")}function Ne(t,e){1&t&&C.Nb(0,"ntv-person",12),2&t&&C.ic("person",e.$implicit)}function Be(t,e){if(1&t&&(C.Sb(0,"mat-accordion"),C.xc(1,Ne,1,1,"ntv-person",11),C.Rb()),2&t){var r=C.dc().ngIf;C.Bb(1),C.ic("ngForOf",r.customers)}}function Pe(t,e){1&t&&(C.Sb(0,"p"),C.zc(1,"\u041e\u0448\u0438\u0431\u043a\u0430"),C.Rb())}function je(t,e){if(1&t){var r=C.Tb();C.Sb(0,"ng-scrollbar",2),C.Sb(1,"div",3),C.Sb(2,"mat-form-field",4),C.Sb(3,"mat-label"),C.zc(4,"\u043f\u043e\u0438\u0441\u043a \u043f\u043e \u0438\u043c\u0435\u043d\u0438"),C.Rb(),C.Nb(5,"input",5),C.Sb(6,"mat-autocomplete",6,7),C.Zb("optionSelected",function(t){return C.pc(r),C.dc().setCustomer(t)}),C.xc(8,xe,2,2,"mat-option",8),C.Rb(),C.Rb(),C.xc(9,Fe,1,0,"ntv-spinner",9),C.xc(10,Be,2,1,"mat-accordion",9),C.xc(11,Pe,2,0,"p",9),C.Rb(),C.Rb()}if(2&t){var n=e.ngIf,o=C.nc(7),i=C.dc();C.Bb(5),C.ic("formControl",i.name)("matAutocomplete",o),C.Bb(3),C.ic("ngForOf",i.autocompleteOptions),C.Bb(1),C.ic("ngIf",n.loading),C.Bb(1),C.ic("ngIf",n.customers.length),C.Bb(1),C.ic("ngIf",n.err)}}var ze,Me,we,Ie=[{path:"",component:(ze=function(){function t(e,r,n,o){u(this,t),this.store=e,this.dialog=r,this.fb=n,this.addOrderService=o,this.autocompleteOptions=[],this.destroyer$$=new d.a}return l(t,[{key:"ngOnInit",value:function(){this.state=this.store.select("customers"),this.store.dispatch(h.a.searchPending({name:""})),this.initSearch()}},{key:"ngOnDestroy",value:function(){this.destroyer$$.next(),this.destroyer$$.complete()}},{key:"showAddOrderDialog",value:function(){this.dialog.open(wt)}},{key:"setCustomer",value:function(t){this.store.dispatch(h.a.searchSuccess({customers:[t.option.value]})),this.name.setValue(t.option.value.name)}},{key:"initSearch",value:function(){this.name=this.fb.control(""),this.initAutocomplete()}},{key:"initAutocomplete",value:function(){var t=this;this.name.valueChanges.pipe(Object(p.a)(this.destroyer$$),Object(f.a)(300),Object(g.a)(function(e){return t.prevName&&t.prevName===e?Object(m.a)(t.autocompleteOptions):(t.prevName=e,t.addOrderService.getPersonsByName(e))})).subscribe(function(e){t.autocompleteOptions=e})}}]),t}(),ze.\u0275fac=function(t){return new(t||ze)(C.Mb(It.h),C.Mb(B.b),C.Mb(z.e),C.Mb(N))},ze.\u0275cmp=C.Gb({type:ze,selectors:[["ntv-people"]],decls:5,vars:3,consts:[["class","scrollbar",4,"ngIf"],["mat-fab","",1,"add-order",3,"click"],[1,"scrollbar"],[1,"people"],["appearance","standard",1,"search"],["matInput","",3,"formControl","matAutocomplete"],[3,"optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"value"],[3,"person",4,"ngFor","ngForOf"],[3,"person"]],template:function(t,e){1&t&&(C.xc(0,je,12,6,"ng-scrollbar",0),C.ec(1,"async"),C.Sb(2,"button",1),C.Zb("click",function(){return e.showAddOrderDialog()}),C.Sb(3,"mat-icon"),C.zc(4,"add"),C.Rb(),C.Rb()),2&t&&C.ic("ngIf",C.fc(1,1,e.state))},directives:[$.k,T.a,A.a,q.a,M.c,M.f,w.b,z.c,I.c,z.n,z.f,I.a,$.j,D.n,Ct.a,j.a,Ce],pipes:[$.b],styles:["[_nghost-%COMP%]{display:block}.search[_ngcontent-%COMP%]{width:100%}.people[_ngcontent-%COMP%]{display:grid;grid-gap:16px;padding:16px}.scrollbar[_ngcontent-%COMP%]{max-height:calc(100vh - 64px);min-height:calc(100vh - 64px)}.add-order[_ngcontent-%COMP%]{position:fixed;right:24px;bottom:24px;z-index:2}"]}),ze)}],$e=((Me=function t(){u(this,t)}).\u0275mod=C.Kb({type:Me}),Me.\u0275inj=C.Jb({factory:function(t){return new(t||Me)},imports:[[b.h.forChild(Ie)],b.h]}),Me),Te=i("PCNd"),Ae=((we=function t(){u(this,t)}).\u0275mod=C.Kb({type:we}),we.\u0275inj=C.Jb({factory:function(t){return new(t||we)},imports:[[$e,Te.a]]}),we)}}])}();