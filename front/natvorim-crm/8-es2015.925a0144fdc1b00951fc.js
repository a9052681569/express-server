(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{u77b:function(e,t,r){"use strict";r.r(t),r.d(t,"ActualShipmentModule",function(){return se});var n=r("tyNb"),a=r("hgo/"),s=r("ufcJ"),c=r("z6cu"),o=r("eIep"),i=r("vkgz"),d=r("JIr8"),l=r("fXoL"),p=r("AytR"),b=r("tk/3");let h=(()=>{class e{constructor(e){this.http=e}search(e){return this.http.post(p.a.apiEndpoints.actualShipment,e)}sendedStatusChange(e){return this.http.post(p.a.apiEndpoints.actualShipmentPatchSended,{data:e})}}return e.\u0275fac=function(t){return new(t||e)(l.Wb(b.a))},e.\u0275prov=l.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var u=r("dNgK");let f=(()=>{class e extends s.a{constructor(e,t){super(m),this.asService=e,this.snack=t,this.search=this.effect(e=>e.pipe(Object(o.a)(e=>(this.searchPending(),this.asService.search(e).pipe(Object(i.a)(e=>{console.log(e),this.searchSuccess(e)}),Object(d.a)(e=>(this.searchError(),Object(c.a)(e)))))))),this.sendedChange=this.effect(e=>e.pipe(Object(o.a)(e=>this.asService.sendedStatusChange(e).pipe(Object(i.a)(e=>{this.sendedChangeSuccess(e)}),Object(d.a)(e=>(this.snack.open("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0438 \u0441\u0442\u0430\u0442\u0443\u0441\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043d\u043e\u0441\u0442\u0438",void 0,{duration:3e3}),Object(c.a)(e))))))),this.sendedChangeSuccess=this.updater((e,t)=>{const r=e.data.slice();return r.forEach(e=>{e.ordersByType.forEach(e=>{e.orders.forEach(e=>{t.ids.includes(e.orderId)&&(e.sended=t.sended)})})}),Object.assign(Object.assign({},e),{data:r})}),this.searchPending=this.updater(e=>Object.assign(Object.assign({},e),{data:[],loadingState:a.a.loading})),this.searchSuccess=this.updater((e,t)=>Object.assign(Object.assign({},e),{data:t,loadingState:a.a.default})),this.searchError=this.updater(e=>Object.assign(Object.assign({},e),{loadingState:a.a.err}))}}return e.\u0275fac=function(t){return new(t||e)(l.Wb(h),l.Wb(u.a))},e.\u0275prov=l.Ib({token:e,factory:e.\u0275fac}),e})();const m={data:[],loadingState:a.a.default};var g=r("ofXK"),v=r("G1Gu"),y=r("XNiG"),S=r("IzEk"),O=r("1G5W"),j=r("Kj3r"),w=r("Qw0g"),F=r("Wcn/");const k={data:{shipmentDate:"",shipmentType:F.d.cdek,notSended:!0},loadingState:a.a.default};var I=r("3Pt+"),C=r("LRne");let R=(()=>{class e{constructor(){}updateFormData(e){return localStorage.setItem("ntv-as-filter-form-data",JSON.stringify(e)),Object(C.a)(e)}getFormData(){const e=localStorage.getItem("ntv-as-filter-form-data"),t=e?JSON.parse(e):k.data;return Object(C.a)(t)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=l.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),x=(()=>{class e extends s.a{constructor(e){super(k),this.ffs=e,this.saveForm=this.effect(e=>e.pipe(Object(o.a)(e=>this.ffs.updateFormData(e).pipe(Object(i.a)(e=>{this.reqFormSuccess(e)}),Object(d.a)(e=>(this.reqFormError(),Object(c.a)(e))))))),this.setFormData=this.effect(e=>e.pipe(Object(o.a)(()=>this.ffs.getFormData().pipe(Object(i.a)(e=>{this.reqFormSuccess(e)}),Object(d.a)(e=>(this.reqFormError(),Object(c.a)(e))))))),this.reqFormSuccess=this.updater((e,t)=>Object.assign(Object.assign({},e),{data:t,loadingState:a.a.default})),this.reqFormError=this.updater(e=>Object.assign(Object.assign({},e),{loadingState:a.a.err}))}}return e.\u0275fac=function(t){return new(t||e)(l.Wb(R))},e.\u0275prov=l.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var T=r("kmnG"),B=r("d3UM"),A=r("bSwM"),M=r("bTqV"),P=r("FKr1");function _(e,t){if(1&e&&(l.Sb(0,"mat-option",7),l.Ac(1),l.Rb()),2&e){const e=t.$implicit;l.ic("value",e.date),l.Bb(1),l.Cc(" ",e.name," ")}}function N(e,t){if(1&e&&(l.Sb(0,"mat-option",7),l.Ac(1),l.Rb()),2&e){const e=t.$implicit;l.ic("value",e),l.Bb(1),l.Cc(" ",e," ")}}let $=(()=>{class e{constructor(e,t,r){this.fb=e,this.formStore=t,this.asStore=r,this.destroyer$$=new y.a,this.shipmentTypes=[...Object.values(F.d),"\u0432\u0441\u0435"],this.months=w.b}ngOnInit(){this.initForm(),this.formStore.setFormData(),this.setFormDataFromSaved(),this.initFormSaver(),this.search()}ngOnDestroy(){this.destroyer$$.next(),this.destroyer$$.complete()}search(){this.asStore.search(this.form.value)}initForm(){this.form=this.fb.group(k.data)}setFormDataFromSaved(){this.formStore.select(e=>e.data).pipe(Object(S.a)(1),Object(i.a)(e=>{this.form.setValue(e)})).subscribe()}initFormSaver(){this.form.valueChanges.pipe(Object(O.a)(this.destroyer$$),Object(j.a)(500)).subscribe(e=>{this.formStore.saveForm(e)})}}return e.\u0275fac=function(t){return new(t||e)(l.Mb(I.e),l.Mb(x),l.Mb(f))},e.\u0275cmp=l.Gb({type:e,selectors:[["ntv-as-filter-form"]],decls:15,vars:3,consts:[[1,"form",3,"formGroup","ngSubmit"],["appearance","standard",1,"low-control","form__control"],["formControlName","shipmentDate"],[3,"value",4,"ngFor","ngForOf"],["formControlName","shipmentType"],["formControlName","notSended"],["mat-raised-button","","color","accent","type","submit",1,"form__control"],[3,"value"]],template:function(e,t){1&e&&(l.Sb(0,"form",0),l.Zb("ngSubmit",function(){return t.search()}),l.Sb(1,"mat-form-field",1),l.Sb(2,"mat-label"),l.Ac(3,"\u0414\u0430\u0442\u0430"),l.Rb(),l.Sb(4,"mat-select",2),l.yc(5,_,2,2,"mat-option",3),l.Rb(),l.Rb(),l.Sb(6,"mat-form-field",1),l.Sb(7,"mat-label"),l.Ac(8,"\u0422\u0438\u043f \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438"),l.Rb(),l.Sb(9,"mat-select",4),l.yc(10,N,2,2,"mat-option",3),l.Rb(),l.Rb(),l.Sb(11,"mat-checkbox",5),l.Ac(12,"\u043d\u0435 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u0435"),l.Rb(),l.Sb(13,"button",6),l.Ac(14," search "),l.Rb(),l.Rb()),2&e&&(l.ic("formGroup",t.form),l.Bb(5),l.ic("ngForOf",t.months),l.Bb(5),l.ic("ngForOf",t.shipmentTypes))},directives:[I.v,I.o,I.h,T.c,T.f,B.a,I.n,I.g,g.j,A.a,M.a,P.n],styles:["[_nghost-%COMP%]{align-items:center;width:100%}.form[_ngcontent-%COMP%], [_nghost-%COMP%]{display:grid}.form[_ngcontent-%COMP%]{grid-gap:16px;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));padding:16px;align-items:flex-end}"]}),e})();var E=r("4Kj8"),D=r("7EHt");let G=(()=>{class e{constructor(e){this.store=e}get isAllSended(){return this.orderType.orders.every(e=>e.sended)}changeAllSended(e){e.source.checked=!e.checked;const t={ids:this.orderType.orders.map(e=>e.orderId),sended:e.checked};this.store.sendedChange(t)}}return e.\u0275fac=function(t){return new(t||e)(l.Mb(f))},e.\u0275cmp=l.Gb({type:e,selectors:[["ntv-actual-order-type"]],inputs:{orderType:"orderType"},decls:5,vars:3,consts:[[3,"checked","click","change"]],template:function(e,t){1&e&&(l.Sb(0,"div"),l.Ac(1),l.Rb(),l.Sb(2,"div"),l.Ac(3),l.Rb(),l.Sb(4,"mat-checkbox",0),l.Zb("click",function(e){return e.stopPropagation()})("change",function(e){return t.changeAllSended(e)}),l.Rb()),2&e&&(l.Bb(1),l.Bc(t.orderType.ordersType),l.Bb(2),l.Bc(t.orderType.orders.length),l.Bb(1),l.ic("checked",t.isAllSended))},directives:[A.a],styles:["[_nghost-%COMP%]{width:100%;display:grid;grid-template-columns:repeat(3,1fr);color:rgba(0,0,0,.54);font-size:.75rem;font-weight:500}"]}),e})();var z=r("Wp6s"),J=r("e1Hi"),q=r("3tz+");function K(e,t){if(1&e&&l.Nb(0,"ntv-overlined",5),2&e){const e=l.dc();l.ic("value",e.order.track)}}function W(e,t){if(1&e&&l.Nb(0,"ntv-overlined",8),2&e){const e=l.dc(2);l.ic("value",e.order.comment)}}function X(e,t){if(1&e&&(l.Qb(0),l.yc(1,W,1,1,"ntv-overlined",6),l.Nb(2,"ntv-order-structure",7),l.Pb()),2&e){const e=l.dc();l.Bb(1),l.ic("ngIf",e.order.comment),l.Bb(1),l.ic("orderStructure",e.order.orderStructure)}}function Z(e,t){if(1&e&&l.Nb(0,"ntv-overlined",9),2&e){const e=l.dc();l.ic("value",e.order.address.city+" "+e.order.address.address)}}let H=(()=>{class e{constructor(e){this.store=e,this.showStructure=!1,this.showAddress=!1}ngOnInit(){this.orderType===F.c.complicated&&(this.showStructure=!0),this.orderType===F.c.theatres&&(this.showStructure=!0,this.showAddress=!0)}changeSended(e){this.store.sendedChange({ids:[this.order.orderId],sended:e})}}return e.\u0275fac=function(t){return new(t||e)(l.Mb(f))},e.\u0275cmp=l.Gb({type:e,selectors:[["ntv-actual-shipment-order"]],inputs:{order:"order",orderType:"orderType"},decls:8,vars:5,consts:[[1,"card"],["color","accent",3,"checked","click"],["overline","\u043d\u043e\u043c\u0435\u0440",3,"value",4,"ngIf"],[4,"ngIf"],["overline","\u0430\u0434\u0440\u0435\u0441",3,"value",4,"ngIf"],["overline","\u043d\u043e\u043c\u0435\u0440",3,"value"],["overline","\u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439",3,"value",4,"ngIf"],[3,"orderStructure"],["overline","\u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439",3,"value"],["overline","\u0430\u0434\u0440\u0435\u0441",3,"value"]],template:function(e,t){1&e&&(l.Sb(0,"mat-card",0),l.Sb(1,"p"),l.Ac(2),l.Rb(),l.Sb(3,"mat-checkbox",1),l.Zb("click",function(e){return e.preventDefault(),t.changeSended(!t.order.sended)}),l.Ac(4," \u041e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043e "),l.Rb(),l.yc(5,K,1,1,"ntv-overlined",2),l.yc(6,X,3,2,"ng-container",3),l.yc(7,Z,1,1,"ntv-overlined",4),l.Rb()),2&e&&(l.Bb(2),l.Bc(t.order.name),l.Bb(1),l.ic("checked",t.order.sended),l.Bb(2),l.ic("ngIf",t.order.track),l.Bb(1),l.ic("ngIf",t.showStructure),l.Bb(1),l.ic("ngIf",t.showAddress))},directives:[z.a,A.a,g.k,J.a,q.a],styles:["[_nghost-%COMP%]{display:block}.card[_ngcontent-%COMP%]{width:100%;box-sizing:border-box;display:grid;gap:16px}"]}),e})();function L(e,t){if(1&e&&l.Nb(0,"ntv-actual-shipment-order",9),2&e){const e=t.$implicit,r=l.dc(2).$implicit;l.ic("order",e)("orderType",r.ordersType)}}function Q(e,t){if(1&e&&(l.Sb(0,"div",7),l.yc(1,L,1,2,"ntv-actual-shipment-order",8),l.Rb()),2&e){const e=l.dc().$implicit;l.Bb(1),l.ic("ngForOf",e.orders)}}function V(e,t){if(1&e&&(l.Sb(0,"mat-expansion-panel",3),l.Sb(1,"mat-expansion-panel-header",4),l.Nb(2,"ntv-actual-order-type",5),l.Rb(),l.yc(3,Q,2,1,"ng-template",6),l.Rb()),2&e){const e=t.$implicit;l.Bb(2),l.ic("orderType",e)}}let U=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=l.Gb({type:e,selectors:[["ntv-actual-shipment-type"]],inputs:{type:"type"},decls:5,vars:4,consts:[[1,"shipment-type"],["displayMode","flat"],["hideToggle","","class","mat-elevation-z0",4,"ngFor","ngForOf"],["hideToggle","",1,"mat-elevation-z0"],[1,"row"],[3,"orderType"],["matExpansionPanelContent",""],[1,"orders-container"],[3,"order","orderType",4,"ngFor","ngForOf"],[3,"order","orderType"]],template:function(e,t){1&e&&(l.Sb(0,"h3",0),l.Ac(1),l.ec(2,"titlecase"),l.Rb(),l.Sb(3,"mat-accordion",1),l.yc(4,V,4,1,"mat-expansion-panel",2),l.Rb()),2&e&&(l.Bb(1),l.Bc(l.fc(2,2,t.type.shipmentType)),l.Bb(3),l.ic("ngForOf",t.type.ordersByType))},directives:[D.a,g.j,D.c,D.f,G,D.d,H],pipes:[g.r],styles:["[_nghost-%COMP%]{display:block;width:100%}.row[_ngcontent-%COMP%]{padding:0 100px}.orders-container[_ngcontent-%COMP%]{display:grid;grid-gap:16px;padding:16px;grid-template-columns:repeat(auto-fill,minmax(200px,1fr))}"]}),e})();function Y(e,t){1&e&&l.Nb(0,"ntv-spinner")}function ee(e,t){1&e&&l.Nb(0,"ntv-actual-shipment-type",6),2&e&&l.ic("type",t.$implicit)}function te(e,t){if(1&e&&(l.Sb(0,"ng-scrollbar",1),l.Sb(1,"div",2),l.Nb(2,"ntv-as-filter-form"),l.Sb(3,"div",3),l.Sb(4,"div"),l.Ac(5,"\u0422\u0438\u043f \u0437\u0430\u043a\u0430\u0437\u043e\u0432"),l.Rb(),l.Sb(6,"div"),l.Ac(7,"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e"),l.Rb(),l.Sb(8,"div"),l.Ac(9,"\u0412\u0441\u0435 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u044b"),l.Rb(),l.Rb(),l.yc(10,Y,1,0,"ntv-spinner",4),l.yc(11,ee,1,1,"ntv-actual-shipment-type",5),l.Rb(),l.Rb()),2&e){const e=t.ngIf,r=l.dc();l.Bb(10),l.ic("ngIf",e.loadingState===r.loadingStates.loading),l.Bb(1),l.ic("ngForOf",e.data)}}const re=[{path:"",component:(()=>{class e{constructor(e){this.store=e,this.loadingStates=a.a}ngOnInit(){this.actualShipmentState$=this.store.select(e=>e)}}return e.\u0275fac=function(t){return new(t||e)(l.Mb(f))},e.\u0275cmp=l.Gb({type:e,selectors:[["ntv-actual-shipment"]],features:[l.Ab([f])],decls:2,vars:3,consts:[["class","scrollbar",4,"ngIf"],[1,"scrollbar"],[1,"scrollbar__content"],[1,"table-header"],[4,"ngIf"],[3,"type",4,"ngFor","ngForOf"],[3,"type"]],template:function(e,t){1&e&&(l.yc(0,te,12,2,"ng-scrollbar",0),l.ec(1,"async")),2&e&&l.ic("ngIf",l.fc(1,1,t.actualShipmentState$))},directives:[g.k,v.a,$,g.j,E.a,U],pipes:[g.b],styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}.table-header[_ngcontent-%COMP%]{width:100%;padding:0 100px 16px;display:grid;grid-template-columns:repeat(3,1fr);color:rgba(0,0,0,.54);font-size:.75rem;font-weight:500}.scrollbar[_ngcontent-%COMP%]{max-height:calc(100vh - 64px);min-height:calc(100vh - 64px)}.scrollbar__content[_ngcontent-%COMP%]{padding:0 16px}"]}),e})()}];let ne=(()=>{class e{}return e.\u0275mod=l.Kb({type:e}),e.\u0275inj=l.Jb({factory:function(t){return new(t||e)},imports:[[n.h.forChild(re)],n.h]}),e})();var ae=r("PCNd");let se=(()=>{class e{}return e.\u0275mod=l.Kb({type:e}),e.\u0275inj=l.Jb({factory:function(t){return new(t||e)},imports:[[ne,ae.a]]}),e})()}}]);